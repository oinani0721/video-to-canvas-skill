# V2 Lore Engine æ¶æ„

> æ¥æº: video-to-md/prompt_builder_v2.py

V2 æ¶æ„å€Ÿé‰´ Lore Engine çš„åˆ†å±‚æç¤ºè¯è®¾è®¡ï¼Œè§£å†³ V1 "æµæ°´è´¦"é—®é¢˜ã€‚

---

## æ ¸å¿ƒæ”¹è¿›

| é—®é¢˜ | V1 | V2 |
|------|----|----|
| ç»„ç»‡æ–¹å¼ | æŒ‰æ—¶é—´ç‚¹ï¼ˆ138ä¸ªç« èŠ‚ï¼‰| æŒ‰çŸ¥è¯†ç»“æ„ï¼ˆ7ä¸ªä¸»é¢˜ï¼‰|
| æˆªå›¾å¤„ç† | æ¯ä¸ªæˆªå›¾ä¸€ä¸ªç« èŠ‚ | æˆªå›¾åˆ†é…åˆ°çŸ¥è¯†ç‚¹ä¸‹ |
| å†…å®¹æ·±åº¦ | å•ä¸€é£æ ¼ | ä¸‰ç§æ·±åº¦å¯é€‰ |
| çŸ¥è¯†è¡¥å…¨ | æ—  | æ™ºèƒ½æ¨ç†è¡¥å…¨ |

---

## åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       BASE_INSTRUCTIONS             â”‚  åŸºç¡€æŒ‡ä»¤ï¼ˆè§’è‰²ã€è¯­è¨€ã€æ ¼å¼ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       CONTENT_MODES                 â”‚  å†…å®¹ç±»å‹æ¨¡å¼
â”‚  video_tutorial | lecture | code    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       DEPTH_LEVELS                  â”‚  æ·±åº¦æ§åˆ¶
â”‚  short_hand | balanced | deep_dive  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    HIERARCHICAL_STRUCTURE           â”‚  åˆ†å±‚ç»„ç»‡ç»“æ„
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    SCREENSHOT_INTEGRATION           â”‚  æˆªå›¾é›†æˆè§„åˆ™
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    INTELLIGENT_INFERENCE            â”‚  æ™ºèƒ½æ¨ç†è¡¥å…¨
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         AI_SUMMARY                  â”‚  AI æ‘˜è¦
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å†…å®¹ç±»å‹æ¨¡å¼ (CONTENT_MODES)

### video_tutorialï¼ˆè§†é¢‘æ•™ç¨‹ï¼‰

```
ç‰¹ç‚¹ï¼š
- å¤§é‡æ“ä½œæ¼”ç¤ºå’Œç•Œé¢åˆ‡æ¢
- è®²è§£è€…è¾¹æ“ä½œè¾¹è§£é‡Š
- å¿«é€Ÿçš„ç•Œé¢å˜åŒ–

å¤„ç†è¦æ±‚ï¼š
- å°†è¿ç»­çš„æ“ä½œåºåˆ—åˆå¹¶ä¸ºå®Œæ•´çš„åŠŸèƒ½è¯´æ˜
- æå–æ“ä½œèƒŒåçš„ç›®çš„å’Œä»·å€¼
- ä¸è¦é€ä¸ªæè¿°"ç‚¹å‡»äº†ä»€ä¹ˆ"ï¼Œè€Œæ˜¯è§£é‡Š"ä¸ºä»€ä¹ˆè¿™æ ·åš"
```

### lectureï¼ˆè®²åº§/æ¼”ç¤ºï¼‰

```
ç‰¹ç‚¹ï¼š
- å¹»ç¯ç‰‡é©±åŠ¨
- æ¦‚å¿µå’Œç†è®ºè®²è§£
- è¾ƒæ…¢çš„èŠ‚å¥

å¤„ç†è¦æ±‚ï¼š
- æå–æ ¸å¿ƒæ¦‚å¿µå’Œå®šä¹‰
- ä¿ç•™é‡è¦çš„æ¨ç†è¿‡ç¨‹
- è¡¥å……å¿…è¦çš„èƒŒæ™¯çŸ¥è¯†
```

### code_demoï¼ˆç¼–ç¨‹æ•™ç¨‹ï¼‰

```
ç‰¹ç‚¹ï¼š
- ä»£ç ç¼–å†™å’Œè¿è¡Œ
- è°ƒè¯•è¿‡ç¨‹
- æŠ€æœ¯æ¦‚å¿µè§£é‡Š

å¤„ç†è¦æ±‚ï¼š
- ä¿ç•™å®Œæ•´çš„ä»£ç ç¤ºä¾‹
- è§£é‡Šä»£ç çš„ä½œç”¨å’ŒåŸç†
- æ ‡æ³¨å¸¸è§é”™è¯¯å’Œæ³¨æ„äº‹é¡¹
```

---

## æ·±åº¦æ§åˆ¶ (DEPTH_LEVELS)

### short_handï¼ˆæç®€æ¨¡å¼ï¼‰

```markdown
è¾“å‡ºé£æ ¼ï¼š
- ä½¿ç”¨è¦ç‚¹åˆ—è¡¨ï¼Œä¸å†™æ®µè½
- åªä¿ç•™æ ¸å¿ƒæœ¯è¯­å’Œå…³ç³»
- ä½¿ç”¨ --> è¡¨ç¤ºæ¦‚å¿µå…³ç³»
- è·³è¿‡ç¤ºä¾‹å’Œè¯¦ç»†è§£é‡Š
- æœ€å¤§ä¿¡æ¯å¯†åº¦

ç¤ºä¾‹è¾“å‡ºï¼š
## åŒå‘é“¾æ¥
- å®šä¹‰ï¼šç¬”è®° A é“¾æ¥ B --> B è‡ªåŠ¨æ˜¾ç¤ºåå‘é“¾æ¥
- ä»·å€¼ï¼šçŸ¥è¯†ç½‘ç»œ --> æ„å¤–å‘ç° --> æ¸è¿›æ„å»º
- æ“ä½œï¼š`[[` --> é€‰æ‹©/è¾“å…¥ --> Enter
```

### balancedï¼ˆå¹³è¡¡æ¨¡å¼ï¼Œæ¨èï¼‰

```markdown
è¾“å‡ºé£æ ¼ï¼š
- æ··åˆä½¿ç”¨æ®µè½å’Œè¦ç‚¹åˆ—è¡¨
- æä¾›æ¸…æ™°çš„æ¦‚å¿µè§£é‡Š
- åŒ…å«ç›¸å…³ç¤ºä¾‹å’Œç±»æ¯”
- å®šä¹‰ä¸æ¸…æ¥šçš„æœ¯è¯­
- åœ¨çŸ¥è¯†ç‚¹åˆ‡æ¢æ—¶è¡¥å……å¿…è¦çš„ä¸Šä¸‹æ–‡
- é€‚åº¦æ‰©å±•ç®€ç•¥çš„å†…å®¹

ç¤ºä¾‹è¾“å‡ºï¼š
## åŒå‘é“¾æ¥ï¼ˆBi-directional Linksï¼‰

åŒå‘é“¾æ¥æ˜¯ Obsidian æœ€å¼ºå¤§çš„åŠŸèƒ½ï¼Œå®ƒè®©ç¬”è®°ä¹‹é—´å½¢æˆç½‘çŠ¶çŸ¥è¯†ç»“æ„ã€‚

### ä»€ä¹ˆæ˜¯åŒå‘é“¾æ¥ï¼Ÿ

å½“ç¬”è®° A é“¾æ¥åˆ°ç¬”è®° B æ—¶ï¼Œç¬”è®° B ä¼šè‡ªåŠ¨æ˜¾ç¤º"è°é“¾æ¥äº†æˆ‘"ã€‚
è¿™ä¸ä¼ ç»Ÿæ–‡ä»¶å¤¹çš„å•å‘å±‚çº§å…³ç³»å®Œå…¨ä¸åŒã€‚

### å¦‚ä½•åˆ›å»ºï¼Ÿ

1. è¾“å…¥ `[[` è§¦å‘é“¾æ¥å»ºè®®
2. è¾“å…¥å…³é”®è¯ç­›é€‰
3. é€‰æ‹©ç›®æ ‡ç¬”è®°
```

### deep_diveï¼ˆæ·±åº¦æ¨¡å¼ï¼‰

```markdown
è¾“å‡ºé£æ ¼ï¼š
- æä¾›å…¨é¢ã€è¯¦å°½çš„è§£é‡Š
- åŒ…å«ä¸°å¯Œçš„ç¤ºä¾‹å’Œç±»æ¯”
- æ·±å…¥å®šä¹‰æ‰€æœ‰æ¦‚å¿µ
- æ·»åŠ é«˜çº§ç»†èŠ‚å’Œè¾¹ç•Œæƒ…å†µ
- æ¢ç´¢ç›¸å…³ä¸»é¢˜å’Œè¿æ¥
- å¯ä»¥åŒ…å«æ€è€ƒé¢˜åŠ æ·±ç†è§£
- æä¾›ç›´è§‰å’ŒæŠ€æœ¯åŒé‡è§£é‡Š
```

---

## åˆ†å±‚ç»„ç»‡ç»“æ„ (HIERARCHICAL_STRUCTURE)

### ç»“æ„å±‚çº§

```markdown
# è§†é¢‘æ ‡é¢˜

## ä¸€ã€ä¸»é¢˜ç« èŠ‚ï¼ˆæŒ‰çŸ¥è¯†é¢†åŸŸåˆ’åˆ†ï¼Œçº¦ 5-10 ä¸ªï¼‰

### 1.1 å­ä¸»é¢˜ï¼ˆå…·ä½“åŠŸèƒ½/æ¦‚å¿µï¼‰

#### çŸ¥è¯†ç‚¹æè¿°
- è¦ç‚¹ 1 [æ—¶é—´æˆ³]
- è¦ç‚¹ 2

![æˆªå›¾æè¿°](screenshots/mm-ss.jpg)

> ğŸ’¡ æ ¸å¿ƒç†å¿µ/æ³¨æ„äº‹é¡¹
```

### ç»„ç»‡åŸåˆ™

1. **ä¸»é¢˜ç« èŠ‚**ï¼šæŒ‰è§†é¢‘çš„çŸ¥è¯†é¢†åŸŸåˆ’åˆ†ï¼ˆä¸æ˜¯æŒ‰æ—¶é—´é¡ºåºï¼‰
   - ä¾‹å¦‚ï¼šæ ¸å¿ƒåŠŸèƒ½ã€æ’ä»¶ç³»ç»Ÿã€ä½¿ç”¨æŠ€å·§ã€æ³¨æ„äº‹é¡¹

2. **å­ä¸»é¢˜**ï¼šæ¯ä¸ªä¸»é¢˜ä¸‹çš„å…·ä½“åŠŸèƒ½æˆ–æ¦‚å¿µ
   - ä¾‹å¦‚ï¼šåŒå‘é“¾æ¥ã€æœ¬åœ°å­˜å‚¨ã€é«˜è‡ªå®šä¹‰åº¦

3. **çŸ¥è¯†ç‚¹**ï¼šå…·ä½“çš„æ“ä½œæ­¥éª¤æˆ–ç»†èŠ‚
   - æ¯ä¸ªçŸ¥è¯†ç‚¹é…ç›¸å…³æˆªå›¾
   - æ·»åŠ æ—¶é—´æˆ³æ–¹ä¾¿å›çœ‹

4. **æˆªå›¾åˆ†é…**ï¼š
   - å°†æ‰€æœ‰æˆªå›¾åˆ†é…åˆ°å¯¹åº”çš„çŸ¥è¯†ç‚¹ä¸‹
   - ç›¸é‚»çš„ã€æè¿°åŒä¸€æ“ä½œçš„æˆªå›¾å¯ä»¥åˆå¹¶è¯´æ˜
   - ä¸è¦é—æ¼ä»»ä½•æˆªå›¾

### åˆå¹¶åŸåˆ™

å½“å¤šä¸ªæˆªå›¾æè¿°åŒä¸€ä¸ªæ“ä½œæµç¨‹æ—¶ï¼Œåˆå¹¶ä¸ºä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼š

âŒ é”™è¯¯ï¼ˆæ¯ä¸ªæˆªå›¾ä¸€ä¸ªç« èŠ‚ï¼‰ï¼š
```markdown
## åˆ›å»ºé“¾æ¥ [00:48]
## æŸ¥çœ‹ç¬”è®° [00:51]
## è¿”å›æ“ä½œ [00:54]
```

âœ… æ­£ç¡®ï¼ˆåˆå¹¶ä¸ºä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼‰ï¼š
```markdown
### 1.1 åŒå‘é“¾æ¥çš„ä½¿ç”¨

![åˆ›å»ºé“¾æ¥](screenshots/00-48.jpg)
![é“¾æ¥æ•ˆæœ](screenshots/00-51.jpg)

åˆ›å»ºåŒå‘é“¾æ¥çš„æ­¥éª¤ï¼š
1. è¾“å…¥ `[[` è§¦å‘å»ºè®® [00:48]
2. é€‰æ‹©ç›®æ ‡ç¬”è®°ï¼Œç‚¹å‡»è·³è½¬ [00:51]
3. ç‚¹å‡»è¿”å›æŒ‰é’®å›åˆ°åŸç¬”è®° [00:54]
```

---

## æˆªå›¾é›†æˆè§„åˆ™ (SCREENSHOT_INTEGRATION)

### é›†æˆè¦æ±‚

1. **å…¨éƒ¨ä½¿ç”¨**ï¼šå¿…é¡»åœ¨ç¬”è®°ä¸­å¼•ç”¨æ‰€æœ‰æä¾›çš„æˆªå›¾
2. **è¯­ä¹‰æ”¾ç½®**ï¼šå°†æˆªå›¾æ”¾åœ¨æœ€èƒ½è¯´æ˜å…¶å†…å®¹çš„ä½ç½®
3. **åˆå¹¶ç›¸é‚»**ï¼šæè¿°åŒä¸€æ“ä½œçš„è¿ç»­æˆªå›¾å¯ä»¥æ”¾åœ¨ä¸€èµ·
4. **æ·»åŠ æè¿°**ï¼šæ¯å¼ æˆªå›¾ä¸‹æ–¹æ·»åŠ ç®€çŸ­è¯´æ˜

### å¼•ç”¨æ ¼å¼

```markdown
![æè¿°å†…å®¹](screenshots/mm-ss.jpg)
*å›¾ï¼šå…·ä½“è¯´æ˜è¿™å¼ æˆªå›¾å±•ç¤ºäº†ä»€ä¹ˆ [mm:ss]*
```

### åˆ†ç»„ç¤ºä¾‹

å½“ 3 å¼ æˆªå›¾å±•ç¤ºåŒä¸€ä¸ªæ“ä½œæµç¨‹æ—¶ï¼š

```markdown
### åˆ›å»ºåŒå‘é“¾æ¥

![è¾“å…¥é“¾æ¥è¯­æ³•](screenshots/00-48.jpg)
![é€‰æ‹©ç›®æ ‡ç¬”è®°](screenshots/00-51.jpg)
![é“¾æ¥åçš„æ•ˆæœ](screenshots/00-54.jpg)

*ä¸Šå›¾å±•ç¤ºäº†åˆ›å»ºåŒå‘é“¾æ¥çš„å®Œæ•´æµç¨‹ [00:48-00:54]*

æ“ä½œæ­¥éª¤ï¼š
1. åœ¨ç¬”è®°ä¸­è¾“å…¥ `[[` è§¦å‘é“¾æ¥å»ºè®®
2. è¾“å…¥å…³é”®è¯ç­›é€‰ï¼Œé€‰æ‹©ç›®æ ‡ç¬”è®°
3. æŒ‰ Enter ç¡®è®¤ï¼Œé“¾æ¥åˆ›å»ºæˆåŠŸ
```

---

## æ™ºèƒ½æ¨ç†è¡¥å…¨ (INTELLIGENT_INFERENCE)

### ä½•æ—¶è¡¥å…¨

å½“è§†é¢‘ä¸­çš„è§£é‡Šä¸å®Œæ•´æˆ–ä¸æ¸…æ™°æ—¶ï¼š
- ä½¿ç”¨ AI çŸ¥è¯†æ¨ç†å’Œè¡¥å…¨
- å®Œå–„æˆ–çº æ­£ä¸æ¸…æ¥šçš„éƒ¨åˆ†
- ä¸è¦é—æ¼ä»»ä½•é‡è¦ä¿¡æ¯
- å¦‚æœæŸå¤„ç¡®å®æ— æ³•ç†è§£ï¼Œæ·»åŠ ç®€çŸ­è¯´æ˜

### è¡¥å…¨ç¤ºä¾‹

| è§†é¢‘å†…å®¹ | AI è¡¥å…¨ |
|---------|--------|
| è§†é¢‘åªè¯´"ä½¿ç”¨åŒå‘é“¾æ¥" | è§£é‡Šä»€ä¹ˆæ˜¯åŒå‘é“¾æ¥ã€ä¸ºä»€ä¹ˆé‡è¦ |
| è§†é¢‘åªæ¼”ç¤ºæ“ä½œ | è¡¥å……æ“ä½œèƒŒåçš„åŸç† |
| è§†é¢‘æåˆ°ä¸“ä¸šæœ¯è¯­ | æ·»åŠ ç®€çŸ­å®šä¹‰ |

---

## AI æ‘˜è¦ (AI_SUMMARY)

åœ¨ç¬”è®°æœ«å°¾æ·»åŠ ï¼š

```markdown
---

> ğŸ“ **AI æ‘˜è¦**
>
> [50-100å­—çš„å†…å®¹æ€»ç»“ï¼ŒåŒ…å«ï¼š]
> - è§†é¢‘çš„æ ¸å¿ƒä¸»é¢˜
> - æœ€é‡è¦çš„ 2-3 ä¸ªçŸ¥è¯†ç‚¹
> - å¯¹å­¦ä¹ è€…çš„ä»·å€¼
```

---

## PromptBuilderV2 ä½¿ç”¨

```python
from prompt_builder_v2 import PromptBuilderV2

# æ•™ç¨‹è§†é¢‘æ¨èé…ç½®
prompt = (PromptBuilderV2()
    .with_mode("video_tutorial")
    .with_depth("balanced")
    .with_hierarchy()
    .with_screenshots(screenshots)
    .with_inference()
    .with_summary()
    .build())

# è®²åº§è§†é¢‘é…ç½®
prompt = (PromptBuilderV2()
    .with_mode("lecture")
    .with_depth("balanced")
    .with_hierarchy()
    .with_screenshots(screenshots)
    .with_inference()
    .with_summary()
    .build())

# å¿«é€Ÿç¬”è®°é…ç½®
prompt = (PromptBuilderV2()
    .with_mode("video_tutorial")
    .with_depth("short_hand")
    .with_hierarchy()
    .with_screenshots(screenshots)
    .build())
```

---

## ä¸ V1 çš„å…³é”®åŒºåˆ«

| ç»´åº¦ | V1 (BiliNote) | V2 (Lore Engine) |
|------|--------------|------------------|
| ç»„ç»‡é€»è¾‘ | æŒ‰æ—¶é—´é¡ºåº | æŒ‰çŸ¥è¯†ç»“æ„ |
| æˆªå›¾å¤„ç† | æ¯ä¸ªæˆªå›¾ä¸€ç«  | è¯­ä¹‰åˆ†ç»„åˆ°çŸ¥è¯†ç‚¹ |
| å†…å®¹æ·±åº¦ | 9ç§é£æ ¼ï¼ˆcosmeticï¼‰| 3ç§æ·±åº¦ï¼ˆstructuralï¼‰|
| çŸ¥è¯†è¡¥å…¨ | æ—  | æ™ºèƒ½æ¨ç† |
| é€‚ç”¨åœºæ™¯ | å¿«é€Ÿè®°å½• | æ•™å­¦ææ–™ |
