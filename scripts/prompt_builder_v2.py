"""
æç¤ºè¯æ„å»ºå™¨ V2 - åŸºäº Lore Engine æ¶æ„ + ä¸‰é˜¶æ®µæ··åˆç®¡é“

æ ¸å¿ƒæ”¹è¿›ï¼š
1. åˆ†å±‚ç»“æ„ï¼šä¸»é¢˜ç« èŠ‚ â†’ çŸ¥è¯†ç‚¹ â†’ æˆªå›¾ï¼ˆä¸æ¼ä»»ä½•ç»†èŠ‚ï¼‰
2. åŒé€šé“å†…å®¹ï¼šéŸ³é¢‘è½¬å½•ï¼ˆEarsï¼‰+ è§†è§‰æˆªå›¾ï¼ˆEyesï¼‰â†’ å®Œæ•´ç†è§£
3. æ·±åº¦æ§åˆ¶ï¼šshort_hand / balanced / deep_dive
4. æ™ºèƒ½æ¨ç†ï¼šç”¨ LLM çŸ¥è¯†è¡¥å…¨ä¸å®Œæ•´çš„è§£é‡Š
"""

# ============================================================================
# æ™ºèƒ½æ¨ç†æŒ‡ä»¤ï¼ˆæ ¸å¿ƒå·®å¼‚ç‚¹ï¼‰
# ============================================================================

INTELLIGENT_INFERENCE = """
## æ™ºèƒ½å†…å®¹è¡¥å…¨

å½“è§†é¢‘ä¸­çš„è§£é‡Šä¸å®Œæ•´æˆ–ä¸æ¸…æ™°æ—¶ï¼š
- ä½¿ç”¨ä½ çš„çŸ¥è¯†æ¨ç†å’Œè¡¥å…¨
- å®Œå–„æˆ–çº æ­£ä¸æ¸…æ¥šçš„éƒ¨åˆ†
- ä¸è¦é—æ¼ä»»ä½•é‡è¦ä¿¡æ¯
- å¦‚æœæŸå¤„ç¡®å®æ— æ³•ç†è§£ï¼Œæ·»åŠ ç®€çŸ­è¯´æ˜

ç¤ºä¾‹ï¼š
- è§†é¢‘åªè¯´"ä½¿ç”¨åŒå‘é“¾æ¥"â†’ ä½ åº”è¯¥è§£é‡Šä»€ä¹ˆæ˜¯åŒå‘é“¾æ¥ã€ä¸ºä»€ä¹ˆé‡è¦
- è§†é¢‘åªæ¼”ç¤ºæ“ä½œ â†’ ä½ åº”è¯¥è¡¥å……æ“ä½œèƒŒåçš„åŸç†
- è§†é¢‘æåˆ°ä¸“ä¸šæœ¯è¯­ â†’ ä½ åº”è¯¥æ·»åŠ ç®€çŸ­å®šä¹‰
"""

# ============================================================================
# å†…å®¹ç±»å‹æ¨¡å¼ (MODES)
# ============================================================================

CONTENT_MODES = {
    "video_tutorial": """
## è¾“å…¥ç±»å‹ï¼šè§†é¢‘æ•™ç¨‹

è¿™æ˜¯ä¸€ä¸ªè½¯ä»¶/å·¥å…·æ•™ç¨‹è§†é¢‘ï¼Œç‰¹ç‚¹æ˜¯ï¼š
- å¤§é‡æ“ä½œæ¼”ç¤ºå’Œç•Œé¢åˆ‡æ¢
- è®²è§£è€…è¾¹æ“ä½œè¾¹è§£é‡Š
- å¯èƒ½æœ‰å¿«é€Ÿçš„ç•Œé¢å˜åŒ–

å¤„ç†è¦æ±‚ï¼š
- å°†è¿ç»­çš„æ“ä½œåºåˆ—åˆå¹¶ä¸ºå®Œæ•´çš„åŠŸèƒ½è¯´æ˜
- æå–æ“ä½œèƒŒåçš„ç›®çš„å’Œä»·å€¼
- ä¸è¦é€ä¸ªæè¿°"ç‚¹å‡»äº†ä»€ä¹ˆ"ï¼Œè€Œæ˜¯è§£é‡Š"ä¸ºä»€ä¹ˆè¿™æ ·åš"
""",

    "lecture": """
## è¾“å…¥ç±»å‹ï¼šè®²åº§/æ¼”ç¤º

è¿™æ˜¯è®²åº§æˆ–æ¼”ç¤ºç±»è§†é¢‘ï¼Œç‰¹ç‚¹æ˜¯ï¼š
- å¹»ç¯ç‰‡é©±åŠ¨
- æ¦‚å¿µå’Œç†è®ºè®²è§£
- è¾ƒæ…¢çš„èŠ‚å¥

å¤„ç†è¦æ±‚ï¼š
- æå–æ ¸å¿ƒæ¦‚å¿µå’Œå®šä¹‰
- ä¿ç•™é‡è¦çš„æ¨ç†è¿‡ç¨‹
- è¡¥å……å¿…è¦çš„èƒŒæ™¯çŸ¥è¯†
""",

    "code_demo": """
## è¾“å…¥ç±»å‹ï¼šç¼–ç¨‹æ•™ç¨‹

è¿™æ˜¯ç¼–ç¨‹/ä»£ç æ¼”ç¤ºè§†é¢‘ï¼Œç‰¹ç‚¹æ˜¯ï¼š
- ä»£ç ç¼–å†™å’Œè¿è¡Œ
- è°ƒè¯•è¿‡ç¨‹
- æŠ€æœ¯æ¦‚å¿µè§£é‡Š

å¤„ç†è¦æ±‚ï¼š
- ä¿ç•™å®Œæ•´çš„ä»£ç ç¤ºä¾‹
- è§£é‡Šä»£ç çš„ä½œç”¨å’ŒåŸç†
- æ ‡æ³¨å¸¸è§é”™è¯¯å’Œæ³¨æ„äº‹é¡¹
"""
}

# ============================================================================
# æ·±åº¦æ§åˆ¶å±‚ (CONCISENESS)
# ============================================================================

DEPTH_LEVELS = {
    "short_hand": """
## è¾“å‡ºæ·±åº¦ï¼šæç®€æ¨¡å¼

- ä½¿ç”¨è¦ç‚¹åˆ—è¡¨ï¼Œä¸å†™æ®µè½
- åªä¿ç•™æ ¸å¿ƒæœ¯è¯­å’Œå…³ç³»
- ä½¿ç”¨ --> è¡¨ç¤ºæ¦‚å¿µå…³ç³»
- è·³è¿‡ç¤ºä¾‹å’Œè¯¦ç»†è§£é‡Š
- æœ€å¤§ä¿¡æ¯å¯†åº¦

ç¤ºä¾‹è¾“å‡ºï¼š
```
## åŒå‘é“¾æ¥
- å®šä¹‰ï¼šç¬”è®° A é“¾æ¥ B --> B è‡ªåŠ¨æ˜¾ç¤ºåå‘é“¾æ¥
- ä»·å€¼ï¼šçŸ¥è¯†ç½‘ç»œ --> æ„å¤–å‘ç° --> æ¸è¿›æ„å»º
- æ“ä½œï¼š`[[` --> é€‰æ‹©/è¾“å…¥ --> Enter
```
""",

    "balanced": """
## è¾“å‡ºæ·±åº¦ï¼šå¹³è¡¡æ¨¡å¼ï¼ˆæ¨èç”¨äºæ•™å­¦ï¼‰

- æ··åˆä½¿ç”¨æ®µè½å’Œè¦ç‚¹åˆ—è¡¨
- æä¾›æ¸…æ™°çš„æ¦‚å¿µè§£é‡Š
- åŒ…å«ç›¸å…³ç¤ºä¾‹å’Œç±»æ¯”
- å®šä¹‰ä¸æ¸…æ¥šçš„æœ¯è¯­
- åœ¨çŸ¥è¯†ç‚¹åˆ‡æ¢æ—¶è¡¥å……å¿…è¦çš„ä¸Šä¸‹æ–‡
- é€‚åº¦æ‰©å±•ç®€ç•¥çš„å†…å®¹

ç¤ºä¾‹è¾“å‡ºï¼š
```
## åŒå‘é“¾æ¥ï¼ˆBi-directional Linksï¼‰

åŒå‘é“¾æ¥æ˜¯ Obsidian æœ€å¼ºå¤§çš„åŠŸèƒ½ï¼Œå®ƒè®©ç¬”è®°ä¹‹é—´å½¢æˆç½‘çŠ¶çŸ¥è¯†ç»“æ„ã€‚

### ä»€ä¹ˆæ˜¯åŒå‘é“¾æ¥ï¼Ÿ

å½“ç¬”è®° A é“¾æ¥åˆ°ç¬”è®° B æ—¶ï¼Œç¬”è®° B ä¼šè‡ªåŠ¨æ˜¾ç¤º"è°é“¾æ¥äº†æˆ‘"ã€‚
è¿™ä¸ä¼ ç»Ÿæ–‡ä»¶å¤¹çš„å•å‘å±‚çº§å…³ç³»å®Œå…¨ä¸åŒã€‚

### å¦‚ä½•åˆ›å»ºï¼Ÿ

1. è¾“å…¥ `[[` è§¦å‘é“¾æ¥å»ºè®®
2. è¾“å…¥å…³é”®è¯ç­›é€‰
3. é€‰æ‹©ç›®æ ‡ç¬”è®°

### ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ

- **çŸ¥è¯†ç½‘ç»œ**ï¼šç¬”è®°ä¸å†å­¤ç«‹
- **æ„å¤–å‘ç°**ï¼šé€šè¿‡åå‘é“¾æ¥å‘ç°å…³è”
- **æ¸è¿›æ„å»º**ï¼šæ¯æ¬¡é“¾æ¥éƒ½å¼ºåŒ–ç½‘ç»œ
```
""",

    "deep_dive": """
## è¾“å‡ºæ·±åº¦ï¼šæ·±åº¦æ¨¡å¼

- æä¾›å…¨é¢ã€è¯¦å°½çš„è§£é‡Š
- åŒ…å«ä¸°å¯Œçš„ç¤ºä¾‹å’Œç±»æ¯”
- æ·±å…¥å®šä¹‰æ‰€æœ‰æ¦‚å¿µ
- æ·»åŠ é«˜çº§ç»†èŠ‚å’Œè¾¹ç•Œæƒ…å†µ
- æ¢ç´¢ç›¸å…³ä¸»é¢˜å’Œè¿æ¥
- å¯ä»¥åŒ…å«æ€è€ƒé¢˜åŠ æ·±ç†è§£
- æä¾›ç›´è§‰å’ŒæŠ€æœ¯åŒé‡è§£é‡Š
"""
}

# ============================================================================
# åˆ†å±‚ç»“æ„æŒ‡ä»¤ï¼ˆè§£å†³"æ—¢è¦å®Œæ•´åˆè¦ç»“æ„"çš„é—®é¢˜ï¼‰
# ============================================================================

HIERARCHICAL_STRUCTURE = """
## åˆ†å±‚ç»„ç»‡ç»“æ„ï¼ˆå…³é”®ï¼ï¼‰

ä½ å¿…é¡»å°†å†…å®¹ç»„ç»‡ä¸º**åˆ†å±‚ç»“æ„**ï¼Œè€Œä¸æ˜¯æ‰å¹³åˆ—è¡¨ï¼š

### ç»“æ„å±‚çº§

```
# è§†é¢‘æ ‡é¢˜

## ä¸€ã€ä¸»é¢˜ç« èŠ‚ï¼ˆæŒ‰çŸ¥è¯†é¢†åŸŸåˆ’åˆ†ï¼Œçº¦ 5-10 ä¸ªï¼‰

### 1.1 å­ä¸»é¢˜ï¼ˆå…·ä½“åŠŸèƒ½/æ¦‚å¿µï¼‰

#### çŸ¥è¯†ç‚¹æè¿°
- è¦ç‚¹ 1 [æ—¶é—´æˆ³]()
- è¦ç‚¹ 2

![æˆªå›¾æè¿°](screenshots/mm-ss.jpg)

> ğŸ’¡ æ ¸å¿ƒç†å¿µ/æ³¨æ„äº‹é¡¹
```

### ç»„ç»‡åŸåˆ™

1. **ä¸»é¢˜ç« èŠ‚**ï¼šæŒ‰è§†é¢‘çš„çŸ¥è¯†é¢†åŸŸåˆ’åˆ†ï¼ˆä¸æ˜¯æŒ‰æ—¶é—´é¡ºåºï¼‰
   - ä¾‹å¦‚ï¼šæ ¸å¿ƒåŠŸèƒ½ã€æ’ä»¶ç³»ç»Ÿã€ä½¿ç”¨æŠ€å·§ã€æ³¨æ„äº‹é¡¹

2. **å­ä¸»é¢˜**ï¼šæ¯ä¸ªä¸»é¢˜ä¸‹çš„å…·ä½“åŠŸèƒ½æˆ–æ¦‚å¿µ
   - ä¾‹å¦‚ï¼šåŒå‘é“¾æ¥ã€æœ¬åœ°å­˜å‚¨ã€é«˜è‡ªå®šä¹‰åº¦

3. **çŸ¥è¯†ç‚¹**ï¼šå…·ä½“çš„æ“ä½œæ­¥éª¤æˆ–ç»†èŠ‚
   - æ¯ä¸ªçŸ¥è¯†ç‚¹é…ç›¸å…³æˆªå›¾
   - æ·»åŠ æ—¶é—´æˆ³æ–¹ä¾¿å›çœ‹

4. **æˆªå›¾åˆ†é…**ï¼š
   - å°†æ‰€æœ‰æˆªå›¾åˆ†é…åˆ°å¯¹åº”çš„çŸ¥è¯†ç‚¹ä¸‹
   - ç›¸é‚»çš„ã€æè¿°åŒä¸€æ“ä½œçš„æˆªå›¾å¯ä»¥åˆå¹¶è¯´æ˜
   - ä¸è¦é—æ¼ä»»ä½•æˆªå›¾

### åˆå¹¶åŸåˆ™

å½“å¤šä¸ªæˆªå›¾æè¿°åŒä¸€ä¸ªæ“ä½œæµç¨‹æ—¶ï¼Œåˆå¹¶ä¸ºä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼š

âŒ é”™è¯¯ï¼ˆæ¯ä¸ªæˆªå›¾ä¸€ä¸ªç« èŠ‚ï¼‰ï¼š
```
## åˆ›å»ºé“¾æ¥ [00:48]()
## æŸ¥çœ‹ç¬”è®° [00:51]()
## è¿”å›æ“ä½œ [00:54]()
```

âœ… æ­£ç¡®ï¼ˆåˆå¹¶ä¸ºä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼‰ï¼š
```
### 1.1 åŒå‘é“¾æ¥çš„ä½¿ç”¨

![åˆ›å»ºé“¾æ¥](screenshots/00-48.jpg)
![é“¾æ¥æ•ˆæœ](screenshots/00-51.jpg)

åˆ›å»ºåŒå‘é“¾æ¥çš„æ­¥éª¤ï¼š
1. è¾“å…¥ `[[` è§¦å‘å»ºè®® [00:48]()
2. é€‰æ‹©ç›®æ ‡ç¬”è®°ï¼Œç‚¹å‡»è·³è½¬ [00:51]()
3. ç‚¹å‡»è¿”å›æŒ‰é’®å›åˆ°åŸç¬”è®° [00:54]()
```
"""

# ============================================================================
# æˆªå›¾é›†æˆæŒ‡ä»¤
# ============================================================================

SCREENSHOT_INTEGRATION = """
## æˆªå›¾é›†æˆè§„åˆ™

### å¯ç”¨æˆªå›¾åˆ—è¡¨
{screenshot_list}

### ä¸¥æ ¼çº¦æŸï¼ˆå¿…é¡»éµå®ˆï¼ï¼‰

**åªèƒ½å¼•ç”¨ä¸Šé¢åˆ—å‡ºçš„æˆªå›¾æ–‡ä»¶ï¼** ç¦æ­¢ç¼–é€ æˆ–æ¨æµ‹ä¸åœ¨åˆ—è¡¨ä¸­çš„æˆªå›¾è·¯å¾„ã€‚
- å¦‚æœæŸä¸ªæ—¶é—´æ®µæ²¡æœ‰æˆªå›¾ï¼Œå°±ä¸è¦æ’å…¥å›¾ç‰‡å¼•ç”¨ï¼Œç”¨æ–‡å­—æè¿°å³å¯
- æ¯ä¸ª `![...](screenshots/...)` å¼•ç”¨çš„æ–‡ä»¶åå¿…é¡»ä¸ä¸Šé¢åˆ—è¡¨ä¸­çš„è·¯å¾„å®Œå…¨åŒ¹é…
- è¿åæ­¤è§„åˆ™ä¼šå¯¼è‡´ç¬”è®°ä¸­å‡ºç°æŸåçš„å›¾ç‰‡é“¾æ¥

### é›†æˆè¦æ±‚

1. **å…¨éƒ¨ä½¿ç”¨**ï¼šå¿…é¡»åœ¨ç¬”è®°ä¸­å¼•ç”¨æ‰€æœ‰æä¾›çš„æˆªå›¾
2. **è¯­ä¹‰æ”¾ç½®**ï¼šå°†æˆªå›¾æ”¾åœ¨æœ€èƒ½è¯´æ˜å…¶å†…å®¹çš„ä½ç½®
3. **åˆå¹¶ç›¸é‚»**ï¼šæè¿°åŒä¸€æ“ä½œçš„è¿ç»­æˆªå›¾å¯ä»¥æ”¾åœ¨ä¸€èµ·
4. **æ·»åŠ æè¿°**ï¼šæ¯å¼ æˆªå›¾ä¸‹æ–¹æ·»åŠ ç®€çŸ­è¯´æ˜

### æˆªå›¾å¼•ç”¨æ ¼å¼

```markdown
![æè¿°å†…å®¹](screenshots/mm-ss.jpg)
*å›¾ï¼šå…·ä½“è¯´æ˜è¿™å¼ æˆªå›¾å±•ç¤ºäº†ä»€ä¹ˆ [mm:ss]()*
```

### åˆ†ç»„ç¤ºä¾‹

å½“ 3 å¼ æˆªå›¾å±•ç¤ºåŒä¸€ä¸ªæ“ä½œæµç¨‹æ—¶ï¼š

```markdown
### åˆ›å»ºåŒå‘é“¾æ¥

![è¾“å…¥é“¾æ¥è¯­æ³•](screenshots/00-48.jpg)
![é€‰æ‹©ç›®æ ‡ç¬”è®°](screenshots/00-51.jpg)
![é“¾æ¥åçš„æ•ˆæœ](screenshots/00-54.jpg)

*ä¸Šå›¾å±•ç¤ºäº†åˆ›å»ºåŒå‘é“¾æ¥çš„å®Œæ•´æµç¨‹ [00:48-00:54]()*

æ“ä½œæ­¥éª¤ï¼š
1. åœ¨ç¬”è®°ä¸­è¾“å…¥ `[[` è§¦å‘é“¾æ¥å»ºè®®
2. è¾“å…¥å…³é”®è¯ç­›é€‰ï¼Œé€‰æ‹©ç›®æ ‡ç¬”è®°
3. æŒ‰ Enter ç¡®è®¤ï¼Œé“¾æ¥åˆ›å»ºæˆåŠŸ
```
"""

# ============================================================================
# è½¬å½•æ–‡æœ¬é›†æˆæŒ‡ä»¤ï¼ˆä¸‰é˜¶æ®µæ··åˆç®¡é“æ ¸å¿ƒï¼‰
# ============================================================================

TRANSCRIPT_INTEGRATION = """
## éŸ³é¢‘è½¬å½•æ–‡æœ¬ï¼ˆå…³é”®ä¿¡æ¯æ¥æºï¼ï¼‰

ä½ åŒæ—¶æ”¶åˆ°äº†ä¸¤ä¸ªä¿¡æ¯é€šé“ï¼š
1. **è§†è§‰é€šé“**ï¼šæˆªå›¾ï¼ˆå±•ç¤ºå±å¹•ä¸Šçœ‹åˆ°çš„å†…å®¹ï¼‰
2. **éŸ³é¢‘é€šé“**ï¼šè½¬å½•æ–‡æœ¬ï¼ˆè®²è§£è€…å®é™…è¯´çš„è¯ï¼‰

### è½¬å½•æ–‡æœ¬
{transcript_text}

### åŒé€šé“èåˆè§„åˆ™ï¼ˆæœ€é‡è¦ï¼ï¼‰

1. **éŸ³é¢‘ä¼˜å…ˆäºè§†è§‰**ï¼šè®²è§£è€…å£è¿°çš„å†…å®¹æ˜¯ç¬”è®°çš„ä¸»å¹²ï¼Œæˆªå›¾æ˜¯è¾…åŠ©è¯´æ˜
2. **ä¸é—æ¼å£è¿°å†…å®¹**ï¼šå³ä½¿æˆªå›¾ä¸­æ²¡æœ‰ä½“ç°ï¼Œåªè¦è®²è§£è€…è¯´äº†ï¼Œå°±å¿…é¡»è®°å½•
3. **äº¤å‰éªŒè¯**ï¼š
   - æˆªå›¾å±•ç¤ºçš„æ“ä½œ + è®²è§£è€…çš„è§£é‡Š â†’ å®Œæ•´çš„çŸ¥è¯†ç‚¹
   - è®²è§£è€…æåˆ°ä½†æˆªå›¾æœªå±•ç¤ºçš„ â†’ ä»ç„¶è®°å½•ï¼ˆæ ‡æ³¨ä¸ºå£è¿°å†…å®¹ï¼‰
   - æˆªå›¾å±•ç¤ºä½†è®²è§£è€…æœªæåŠçš„ â†’ ç®€è¦æè¿°å³å¯
4. **æ—¶é—´å¯¹é½**ï¼šåˆ©ç”¨æ—¶é—´æˆ³å°†è½¬å½•æ–‡æœ¬ä¸æˆªå›¾å¯¹åº”
   - æˆªå›¾æ—¶é—´æˆ³é™„è¿‘çš„è½¬å½•å†…å®¹ = è¯¥æˆªå›¾çš„è¯­éŸ³è§£é‡Š

### å¸¸è§é—æ¼åœºæ™¯ï¼ˆå¿…é¡»é¿å…ï¼ï¼‰

- âŒ è®²è§£è€…å£è¿°äº† 3 ç§ç±»å‹ï¼Œä½†æˆªå›¾åªæ˜¾ç¤ºæ ‡é¢˜ â†’ åªå†™æ ‡é¢˜
- âœ… è®²è§£è€…å£è¿°äº† 3 ç§ç±»å‹ï¼Œæˆªå›¾åªæ˜¾ç¤ºæ ‡é¢˜ â†’ å®Œæ•´è®°å½• 3 ç§ç±»å‹ + æˆªå›¾

- âŒ è®²è§£è€…è§£é‡Šäº†æ³¨å†Œæµç¨‹ï¼Œä½†å±å¹•æ²¡æœ‰å˜åŒ– â†’ è·³è¿‡
- âœ… è®²è§£è€…è§£é‡Šäº†æ³¨å†Œæµç¨‹ï¼Œå±å¹•æ²¡æœ‰å˜åŒ– â†’ å®Œæ•´è®°å½•æ³¨å†Œæµç¨‹

- âŒ è®²è§£è€…å›ç­”äº†å­¦ç”Ÿé—®é¢˜ï¼Œæˆªå›¾æ˜¯é™æ€å¹»ç¯ç‰‡ â†’ å¿½ç•¥
- âœ… è®²è§£è€…å›ç­”äº†å­¦ç”Ÿé—®é¢˜ï¼Œæˆªå›¾æ˜¯é™æ€å¹»ç¯ç‰‡ â†’ è®°å½• Q&A
"""

# ============================================================================
# åŸºç¡€æŒ‡ä»¤
# ============================================================================

BASE_INSTRUCTIONS = """
ä½ æ˜¯ä¸“ä¸šçš„è§†é¢‘ç¬”è®°æ•´ç†ä¸“å®¶ã€‚

## æ ¸å¿ƒä»»åŠ¡

å°†è§†é¢‘å†…å®¹è½¬åŒ–ä¸º**ç»“æ„åŒ–çš„æ•™å­¦ç¬”è®°**ï¼Œè¦æ±‚ï¼š
1. æŒ‰çŸ¥è¯†ç»“æ„ç»„ç»‡ï¼Œä¸æ˜¯æŒ‰æ—¶é—´æµæ°´è´¦
2. **åŒé€šé“èåˆ**ï¼šåŒæ—¶åˆ©ç”¨éŸ³é¢‘è½¬å½•æ–‡æœ¬å’Œè§†è§‰æˆªå›¾ï¼Œç¡®ä¿å£è¿°å’Œå±å¹•å†…å®¹éƒ½ä¸é—æ¼
3. ä¸é—æ¼ä»»ä½•çŸ¥è¯†ç‚¹å’Œæˆªå›¾
4. è¡¥å……è§†é¢‘ä¸­ä¸å®Œæ•´çš„è§£é‡Š

## è¯­è¨€è¦æ±‚

- è¾“å‡ºä½¿ç”¨**ä¸­æ–‡**
- æŠ€æœ¯æœ¯è¯­ã€ä»£ç ã€å…¬å¼ä¿ç•™è‹±æ–‡
- ç¤ºä¾‹ï¼š"æœºå™¨å­¦ä¹  (Machine Learning) æ˜¯ä¸€ç§..."

## è¾“å‡ºæ ¼å¼

- ä½¿ç”¨ Markdown æ ¼å¼
- ä½¿ç”¨æ ‡é¢˜å±‚çº§ï¼š# ## ### ####
- ä½¿ç”¨è¦ç‚¹åˆ—è¡¨ã€ç¼–å·åˆ—è¡¨
- ä»£ç ä½¿ç”¨ä»£ç å—

## ç¦æ­¢äº‹é¡¹

- ä¸è¦å†™"ä»¥ä¸‹æ˜¯ç¬”è®°"ã€"ç»§ç»­ä¹‹å‰çš„å†…å®¹"ç­‰å…ƒæè¿°
- ä¸è¦æ¯ä¸ªæˆªå›¾éƒ½å•ç‹¬æˆç« 
- ä¸è¦åªæè¿°"ç”¨æˆ·ç‚¹å‡»äº†XXX"ï¼Œè¦è§£é‡Š"ä¸ºä»€ä¹ˆè¿™æ ·åš"
"""

# ============================================================================
# AI æ‘˜è¦
# ============================================================================

AI_SUMMARY = """
## AI æ‘˜è¦

åœ¨ç¬”è®°æœ«å°¾æ·»åŠ ä¸€æ®µä¸“ä¸šæ‘˜è¦ï¼š

```markdown
---

> ğŸ“ **AI æ‘˜è¦**
>
> [50-100å­—çš„å†…å®¹æ€»ç»“ï¼ŒåŒ…å«ï¼š]
> - è§†é¢‘çš„æ ¸å¿ƒä¸»é¢˜
> - æœ€é‡è¦çš„ 2-3 ä¸ªçŸ¥è¯†ç‚¹
> - å¯¹å­¦ä¹ è€…çš„ä»·å€¼
```
"""

# ============================================================================
# V2 æç¤ºè¯æ„å»ºå™¨
# ============================================================================

class PromptBuilderV2:
    """
    Lore Engine é£æ ¼çš„æç¤ºè¯æ„å»ºå™¨ V2

    ä½¿ç”¨æ–¹æ³•ï¼š
        prompt = (PromptBuilderV2()
            .with_mode("video_tutorial")
            .with_depth("balanced")
            .with_screenshots(screenshots)
            .with_inference()
            .with_summary()
            .build())
    """

    def __init__(self):
        self.parts = [BASE_INSTRUCTIONS]
        self._mode = None
        self._depth = None
        self._screenshots = []
        self._has_transcript = False

    def with_mode(self, mode: str) -> "PromptBuilderV2":
        """è®¾ç½®å†…å®¹ç±»å‹æ¨¡å¼"""
        if mode in CONTENT_MODES:
            self._mode = mode
            self.parts.append(CONTENT_MODES[mode])
        return self

    def with_depth(self, depth: str) -> "PromptBuilderV2":
        """è®¾ç½®è¾“å‡ºæ·±åº¦"""
        if depth in DEPTH_LEVELS:
            self._depth = depth
            self.parts.append(DEPTH_LEVELS[depth])
        return self

    def with_screenshots(self, screenshots: list) -> "PromptBuilderV2":
        """è®¾ç½®æˆªå›¾åˆ—è¡¨"""
        self._screenshots = screenshots

        # ç”Ÿæˆæˆªå›¾åˆ—è¡¨
        screenshot_list = []
        for i, s in enumerate(screenshots, 1):
            safe_ts = s["timestamp"].replace(":", "-")
            screenshot_list.append(
                f"{i}. [{s['timestamp']}] {s.get('type', 'other')}: {s['desc']}\n"
                f"   è·¯å¾„: screenshots/{safe_ts}.jpg"
            )

        # æ›¿æ¢å ä½ç¬¦
        integration = SCREENSHOT_INTEGRATION.replace(
            "{screenshot_list}",
            "\n".join(screenshot_list) if screenshot_list else "ï¼ˆæ— æˆªå›¾ï¼‰"
        )
        self.parts.append(integration)
        return self

    def with_transcript(self, transcript_text: str) -> "PromptBuilderV2":
        """
        æ·»åŠ éŸ³é¢‘è½¬å½•æ–‡æœ¬ï¼ˆä¸‰é˜¶æ®µç®¡é“æ ¸å¿ƒï¼‰

        Args:
            transcript_text: å¸¦æ—¶é—´æˆ³çš„è½¬å½•æ–‡æœ¬ï¼Œæ ¼å¼å¦‚ï¼š
                [00:00-00:15] Welcome to CS61C...
                [00:15-00:30] Today we'll cover...
        """
        self._has_transcript = True

        integration = TRANSCRIPT_INTEGRATION.replace(
            "{transcript_text}",
            transcript_text if transcript_text else "ï¼ˆæ— è½¬å½•æ–‡æœ¬ï¼‰"
        )
        self.parts.append(integration)
        return self

    def with_inference(self) -> "PromptBuilderV2":
        """å¯ç”¨æ™ºèƒ½æ¨ç†è¡¥å…¨"""
        self.parts.append(INTELLIGENT_INFERENCE)
        return self

    def with_hierarchy(self) -> "PromptBuilderV2":
        """å¯ç”¨åˆ†å±‚ç»“æ„ç»„ç»‡"""
        self.parts.append(HIERARCHICAL_STRUCTURE)
        return self

    def with_summary(self) -> "PromptBuilderV2":
        """æ·»åŠ  AI æ‘˜è¦"""
        self.parts.append(AI_SUMMARY)
        return self

    def build(self) -> str:
        """æ„å»ºæœ€ç»ˆæç¤ºè¯"""
        return "\n\n".join(self.parts)

    def __str__(self) -> str:
        return (f"PromptBuilderV2(mode={self._mode}, depth={self._depth}, "
                f"screenshots={len(self._screenshots)}, transcript={self._has_transcript})")


# ============================================================================
# é¢„è®¾å·¥å‚å‡½æ•°
# ============================================================================

def create_tutorial_notes_prompt(screenshots: list, transcript: str = "") -> str:
    """åˆ›å»ºæ•™ç¨‹è§†é¢‘ç¬”è®°æç¤ºè¯ï¼ˆæ¨èï¼‰"""
    builder = (PromptBuilderV2()
               .with_mode("video_tutorial")
               .with_depth("balanced")
               .with_hierarchy()
               .with_screenshots(screenshots))
    if transcript:
        builder.with_transcript(transcript)
    return (builder
            .with_inference()
            .with_summary()
            .build())


def create_lecture_notes_prompt(screenshots: list, transcript: str = "") -> str:
    """åˆ›å»ºè®²åº§ç¬”è®°æç¤ºè¯"""
    builder = (PromptBuilderV2()
               .with_mode("lecture")
               .with_depth("balanced")
               .with_hierarchy()
               .with_screenshots(screenshots))
    if transcript:
        builder.with_transcript(transcript)
    return (builder
            .with_inference()
            .with_summary()
            .build())


def create_quick_notes_prompt(screenshots: list, transcript: str = "") -> str:
    """åˆ›å»ºå¿«é€Ÿç¬”è®°æç¤ºè¯"""
    builder = (PromptBuilderV2()
               .with_mode("video_tutorial")
               .with_depth("short_hand")
               .with_hierarchy()
               .with_screenshots(screenshots))
    if transcript:
        builder.with_transcript(transcript)
    return builder.build()


def create_deep_notes_prompt(screenshots: list, transcript: str = "") -> str:
    """åˆ›å»ºæ·±åº¦ç¬”è®°æç¤ºè¯"""
    builder = (PromptBuilderV2()
               .with_mode("video_tutorial")
               .with_depth("deep_dive")
               .with_hierarchy()
               .with_screenshots(screenshots))
    if transcript:
        builder.with_transcript(transcript)
    return (builder
            .with_inference()
            .with_summary()
            .build())


# ============================================================================
# æµ‹è¯•
# ============================================================================

if __name__ == "__main__":
    test_screenshots = [
        {"timestamp": "00:48", "desc": "è¾“å…¥åŒé“¾è¯­æ³•", "type": "ui_change"},
        {"timestamp": "00:51", "desc": "æŸ¥çœ‹é“¾æ¥ç¬”è®°", "type": "demo_state"},
        {"timestamp": "00:54", "desc": "è¿”å›åŸç¬”è®°", "type": "ui_change"},
    ]

    prompt = create_tutorial_notes_prompt(test_screenshots)

    print("=" * 70)
    print("V2 æç¤ºè¯é¢„è§ˆï¼ˆæ•™ç¨‹æ¨¡å¼ + balanced æ·±åº¦ï¼‰ï¼š")
    print("=" * 70)
    print(prompt[:2000] + "\n...(truncated)")
    print(f"\næ€»é•¿åº¦: {len(prompt)} å­—ç¬¦")
